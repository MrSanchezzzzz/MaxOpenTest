import 'package:flutter/material.dart';
import 'package:flutter/widgets.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:maxopentest/blocs/getmovies_states.dart';

import '../blocs/movies_bloc.dart';
import '../entities/movie.dart';
import '../utils/constants.dart';

class BookmarkIndicator extends StatelessWidget {
  const BookmarkIndicator({super.key,required this.movie,required this.onTap});
  final Movie movie;
  final Function() onTap;
  @override
  Widget build(BuildContext context) {
    return BlocBuilder<FavoriteMoviesBloc, GetMoviesState>(
      builder: (context,state){
        bool isFavorite = false;
        if (state is GetMoviesLoaded) {
          isFavorite = context
              .watch<FavoriteMoviesBloc>()
              .movies
              .where((m) => m.id == movie.id)
              .isNotEmpty;
        }
        return  IconButton(
          icon: Image.asset(isFavorite ? 'assets/icons/bookmark-active.png' : 'assets/icons/bookmark-default.png',
              height: Constants.iconSize),
          color: Colors.white,
          onPressed: onTap,
        );
      },
    );
  }
}
